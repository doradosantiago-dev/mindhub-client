<!-- Login component template -->

<!-- HEADER CON LOGO -->
<header class="auth-header" role="banner">
  <div class="auth-header-container">
    <div class="auth-logo">
      <span class="brand-name">
        <span class="logo-mind">MIND</span>
        <span class="logo-hub">HUB</span>
      </span>
    </div>
  </div>
</header>

<div class="login-container">
  <div class="login-card">

    <!-- COLUMNA IZQUIERDA: FORMULARIO -->
    <div class="left-column">
      <!-- HEADER -->
      <header class="login-header">
        <h1 class="login-title">Bienvenido</h1>
        <p class="login-subtitle">Inicia sesión para continuar</p>
      </header>

      <!-- FORMULARIO DE LOGIN -->
      <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="login-form" novalidate>

        <!-- Campo Usuario -->
        <div class="form-group">
          <label for="username" class="form-label">Usuario</label>
          <div class="input-wrapper">
            <input id="username" type="text" formControlName="username" class="form-input"
              [class.error]="usernameControl?.invalid && usernameControl?.touched"
              placeholder="Ingresa tu nombre de usuario" autocomplete="username" aria-describedby="username-error" />

            @if (usernameControl?.invalid && usernameControl?.touched) {
            <div class="error-icon" aria-hidden="true">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10" />
                <line x1="15" y1="9" x2="9" y2="15" />
                <line x1="9" y1="9" x2="15" y2="15" />
              </svg>
            </div>
            }
          </div>

          @if (usernameControl?.invalid && usernameControl?.touched) {
          <div class="error-message" id="username-error" role="alert">
            @if (usernameControl?.errors?.['required']) {
            <span>El usuario es requerido</span>
            }
            @if (usernameControl?.errors?.['minlength']) {
            <span>El usuario debe tener al menos 3 caracteres</span>
            }
          </div>
          }
        </div>

        <!-- Campo Contraseña -->
        <div class="form-group">
          <label for="password" class="form-label">Contraseña</label>
          <div class="input-wrapper">
            <input id="password" [type]="showPassword() ? 'text' : 'password'" formControlName="password"
              class="form-input" [class.error]="passwordControl?.invalid && passwordControl?.touched"
              placeholder="Ingresa tu contraseña" autocomplete="current-password" aria-describedby="password-error" />

            <button type="button" class="password-toggle" (click)="togglePasswordVisibility()"
              [attr.aria-label]="showPassword() ? 'Ocultar contraseña' : 'Mostrar contraseña'" aria-pressed="false">

              @if (showPassword()) {
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                <circle cx="12" cy="12" r="3" />
                <line x1="3" y1="3" x2="21" y2="21" />
                <line x1="10.73" y1="10.73" x2="3" y2="3" />
                <line x1="21" y1="21" x2="13.27" y2="13.27" />
              </svg>
              } @else {
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                <circle cx="12" cy="12" r="3" />
              </svg>
              }
            </button>
          </div>

          @if (passwordControl?.invalid && passwordControl?.touched) {
          <div class="error-message" id="password-error" role="alert">
            @if (passwordControl?.errors?.['required']) {
            <span>La contraseña es requerida</span>
            }
            @if (passwordControl?.errors?.['minlength']) {
            <span>La contraseña debe tener al menos 6 caracteres</span>
            }
          </div>
          }
        </div>

        <!-- Mensaje de Error Global -->
        @if (errorMessage()) {
        <div class="global-error" role="alert" aria-live="polite">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            aria-hidden="true">
            <circle cx="12" cy="12" r="10" />
            <line x1="15" y1="9" x2="9" y2="15" />
            <line x1="9" y1="9" x2="15" y2="15" />
          </svg>
          <span>{{ errorMessage() }}</span>
        </div>
        }

        <!-- Botón de Envío -->
        <button type="submit" class="submit-button" [disabled]="loginForm.invalid || isLoading()"
          [class.loading]="isLoading()" [attr.aria-busy]="isLoading()">

          @if (isLoading()) {
          <div class="spinner" aria-hidden="true"></div>
          <span>Iniciando sesión...</span>
          } @else {
          <span>Iniciar Sesión</span>
          }
        </button>
      </form>

      <!-- FOOTER -->
      <footer class="login-footer">
        <p class="register-text">
          ¿No tienes una cuenta?
          <button type="button" class="link-button" (click)="goToRegister()">
            Regístrate aquí
          </button>
        </p>

        <div class="back-to-landing">
          <a class="back-link" (click)="goToLanding()" role="button" tabindex="0">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
              aria-hidden="true">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
            Volver al Inicio
          </a>
        </div>
      </footer>
    </div>

    <!-- COLUMNA DERECHA: LOGO Y DESCRIPCIÓN -->
    <div class="right-column">
      <div class="brand-section">
        <img src="/login-brand-gemini.png" class="gemini-logo" alt="Gemini MindHub">
        <span class="brand-logo-icon" role="img" aria-label="MindHub Logo"></span>
        <h2 class="brand-title">
          <span class="logo-mind">MIND</span>
          <span class="logo-hub">HUB</span>
        </h2>
        <p class="brand-description">
          Conecta con personas de todo el mundo y comparte tus ideas.
          Una red social moderna para la nueva generación.
        </p>
      </div>
    </div>

  </div>
</div>